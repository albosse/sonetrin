{% extends 'sonetrinDefaultBundle::layout.html.twig' %}
{% block content %}

<header class="jumbotron subhead" id="overview">
  <div class="container">
    <h1>{{ 'Search'|trans }}</h1>
    <p class="lead">Create a search to start browsing social networks.</p>
  </div>
</header>
<hr />

<table class="records_list table table-bordered table-condensed table-striped">
    <thead>
        <tr>
            <th>{{ 'Id'|trans }}</th>
            <th>{{ 'Name'|trans }}</th>
            <th>{{ 'SocialNetwork'|trans }}</th>
            <th>{{ 'Startdate'|trans }}</th>
            <th>{{ 'Enddate'|trans }}</th>
            <th>{{ 'Semantic'|trans }}</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
    {% for entity in entities %}
        <tr>
            <td><a href="{{ path('search_show', { 'id': entity.id }) }}">{{ entity.id }}</a></td>
            <td>{{ entity.name }}</td>
            <td>
                {% for network in entity.socialNetwork %}
                    <a href="{{path('socialnetwork_show',{ 'id':network.id })}}">{{ network.name }}</a>
                {%endfor%}
            </td>
            <td>{% if entity.startDate %}{{ entity.startDate|date('Y-m-d') }}{% endif %}</td>
            <td>{% if entity.endDate %}{{ entity.endDate|date('Y-m-d') }}{% endif %}</td>
            <td><i class="{{ entity.semantic ? 'icon-check' : '' }}"></i></td>
            <td>
               
               {% if entity.hasResult  %} 
                 <a class="btn btn-mini btn-success" href="#modal{{entity.id}}" data-toggle="modal" >
                     <i class="icon-step-forward"></i>
                    {{ 'start'|trans }}
                </a>
               {%else%}
                <a class="btn btn-mini btn-success" href="{{ path('search_run', { 'id': entity.id }) }}">
                     <i class="icon-step-forward"></i>
                    {{ 'start'|trans }}
                 </a>
               {%endif%} 
                 
                    
                    
                <a class="btn btn-mini" href="{{ path('search_show', { 'id': entity.id }) }}">
                    <i class="icon-eye-open"></i>
                    {{ 'show'|trans }}
                </a>
                <a class="btn btn-mini" href="{{ path('search_edit', { 'id': entity.id }) }}">
                    <i class="icon-pencil"></i>
                    {{ 'edit'|trans }}
                </a>   
                {% if entity.hasResult() %}
                    <a class="btn btn-mini btn-info" href="{{ path('result', { 'search': entity.id }) }}">
                        <i class="icon-tasks"></i>
                        {{ 'Results'|trans }}
                    </a>   
                {% endif%}
            </td>
        </tr>
        {%if entity.hasResult%}
        <!-- Modal -->
            <div id="modal{{entity.id}}" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
                <h3 id="myModalLabel">Really start a new search for "{{entity.name}}"?</h3>
              </div>
              <div class="modal-body">
                <p>There are results available for this search. Starting a new Search will delete all old results.
                    Do you really want to start a new search?
                </p>
              </div>
              <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
                <a href="{{ path('search_run', { 'id': entity.id }) }}" class="btn btn-primary">Start a new Search</a>
              </div>
            </div>
        {%endif%}
    {% endfor %}
    </tbody>
</table>

<a class="btn" href="{{ path('search_new') }}">
    <i class="icon-plus"></i>
    {{ 'create a new entry'|trans }}
</a>

{% endblock %}